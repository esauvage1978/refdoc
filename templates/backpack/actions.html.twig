{% macro backpack(twigTemplace,currentState,owner,item,underRubric,visible,hide) %}
	{% import "macros/widgets.html.twig" as widgets %}
	{% import "macros/delele.html.twig" as del %}
	{% set actions = {} %}
	{% if underRubric %}
		{% set actions = actions|merge({ 'left': {url: path('rubric_show',{id:underRubric.rubric.id}),class:'btn-secondary',attr:{title:'retour'}}}) %}
	{% endif %}
	{% set actions = actions|merge({ 'home': {url: path('home'),class:'btn-secondary',attr:{title:'Accueil'}}}) %}
	{% set actions = actions|merge({'divider': null}) %}

	{% set save = { 'save': {onclick: '$(\'#submit_1\').click();',class:'btn-success',attr:{title:'Sauvegarder'}}} %}

	{% if item %}

		{% if hide %}
			{% set url=path('backpacks_hide',{iditem:item}) %}
		{% elseif underRubric and currentState=='published' %}
			{% set url=path('underrubric_show',{visible:'true',id:underRubric.id,idItem:item.id}) %}
		{% else %}
			{% set url=path('backpacks',{visible:'true',currentState:currentState,idItem:item.id}) %}
		{% endif %}

		{% set edit = { 'edit': {url: path('backpack_edit',{id:item.id}),class:'btn-secondary',attr:{title:'Modifier'}}} %}
		{% set delete = { 'delete': {onclick: '$(\'#delete_1\').click();',class:'btn-danger',attr:{title:'Supprimer'}}} %}
		{% set show = { 'show': {url: url,class:'btn-secondary',attr:{title:'Consulter'}}} %}
		{% set history = { 'history': {url: path('backpack_history',{id:item.id}),class:'btn-secondary',attr:{title:'historique des modifications'}}} %}
		{% set workflow = { 'workflow': {url: path('workflow_backpack_history',{id:item.id}),class:'btn-secondary',attr:{title:'historique du workflow'}}} %}

		{% set actions = actions|merge({'divider2': null}) %}


		{% if twigTemplace=='tree' %}
			{% if  item | backpackCanUpdate %}
				{% set actions = actions|merge(edit) %}
			{% endif %}
			{% if  item | backpackCanDelete %}
				{% set actions = actions|merge(delete) %}
				{{ del.delete_form('backpack_del',item.id, null) }}
			{% endif %}
		{% elseif twigTemplace=='comment_add' or twigTemplace=='comments' %}
			{% if  item | backpackCanUpdate %}
				{% set actions = actions|merge(edit) %}

			{% endif %}
			{% set actions = actions|merge(save) %}

		{% elseif twigTemplace=='workflow' %}
			{% set actions = actions|merge() %}
			{% set actions = actions|merge(edit) %}

		{% elseif twigTemplace=='history' %}
			{% set actions = actions|merge(show) %}
			{% if  item | backpackCanDelete %}
				{% set actions = actions|merge(delete) %}
				{{ del.delete_form('backpack_del',item.id, null) }}
			{% endif %}
			{% set actions = actions|merge(edit) %}

		{% elseif twigTemplace=='edit' %}
			{% set actions = actions|merge(workflow) %}
			{% set actions = actions|merge(history) %}
			{% set actions = actions|merge(show) %}
			{% if  item | backpackCanDelete %}
				{% set actions = actions|merge(delete) %}
				{{ del.delete_form('backpack_del',item.id, null) }}
			{% endif %}
			{% set actions = actions|merge(save) %}
		{% endif %}
	{% elseif twigTemplace=='add' %}
		{% set actions = actions|merge(save) %}
	{% endif %}
	{{ widgets.page_actions(actions) }}
{% endmacro %}
