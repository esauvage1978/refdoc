{% extends 'backpack/layout.html.twig' %}

{% import "backpack/actions.html.twig" as actions %}

{% block page_subtitle %}Historique des changements d'état{% endblock %}

{% block breadcrumb %}
    {{ actions.backpack(
        'workflow',
        item.currentState,
        item.owner==app.user,
        item,
        item.underrubric
    ) }}
{% endblock %}

{% block page_content %}
    {{ render(controller('App\\Controller\\GPIController::showGPIAction', { 'page': 'backpack_history_workflow'})) }}
    <div class="row justify-content-center ">
        <div class="col-10">
            {% embed 'widgets/card-widget.html.twig' %}
                {% import "macros/widgets.html.twig" as widgets %}
                {% import "macros/backpack.html.twig" as bpk %}
                {% block card_title_class %} text-info{% endblock %}
                {% block card_title %} {{ widgets.icon('backpack') }} {{ item.name }}{% endblock %}
                {% block card_tools %}
                        {{ widgets.badge_state(item.currentState) }}
                {% endblock %}
                {% block card_body_class %}h-100 bg-light shadow{% endblock %}
                {% block card_body %}
                    {{ bpk.identification(item) }}
                    <hr/>
                    {% embed 'widgets/timeline-widget.html.twig' %}
                        {% block timeline_title %}Création{% endblock %}
                        {% block timeline_title_class %}bg-secondary{% endblock %}
                        {% block timeline_body %}
                            {% import "macros/workflow.html.twig" as workflow %}
                            {% for state in item.backpackStates %}
                                {{ workflow.timeline(state) }}
                            {% endfor %}
                        {% endblock %}
                    {% endembed %}

                {% endblock %}
            {% endembed %}
        </div>
    </div>
{% endblock %}
